import{a as A,c as G,d as M,e as O,g as p,h as U,i as W,j as $,k as B,m as P,n as q}from"./chunk-VY3RHVZS.js";import{a as j}from"./chunk-OWNJBPSF.js";import{Aa as f,Ca as T,Fa as D,L as C,P as _,Q as S,X as F,_a as I,ab as R,ca as s,da as m,eb as V,fb as h,ha as E,l as y,ma as c,pa as N,qa as k,ra as w,sa as r,ta as o,ua as u,va as x,wa as d,xa as L}from"./chunk-OD32AHD5.js";import{a as v,b}from"./chunk-4UQR44R5.js";function z(a,n){if(a&1){let g=x();r(0,"span",14)(1,"i",15),d("click",function(){let i=_(g).$implicit,l=L();return S(l.removeTag(i))}),o(),f(2),o()}if(a&2){let g=n.$implicit;s(2),T(" ",g," ")}}var oe=(()=>{let n=class n{constructor(e,t,i,l){this.articleService=e,this.route=t,this.router=i,this.userService=l,this.tagList=[],this.articleForm=new O({title:new p("",{nonNullable:!0}),description:new p("",{nonNullable:!0}),body:new p("",{nonNullable:!0})}),this.tagField=new p("",{nonNullable:!0}),this.errors=null,this.isSubmitting=!1,this.destroyRef=F(E)}ngOnInit(){this.route.snapshot.params.slug&&y([this.articleService.get(this.route.snapshot.params.slug),this.userService.getCurrentUser()]).pipe(h(this.destroyRef)).subscribe(([e,{user:t}])=>{t.username===e.author.username?(this.tagList=e.tagList,this.articleForm.patchValue(e)):this.router.navigate(["/"])})}addTag(){let e=this.tagField.value;e!=null&&e.trim()!==""&&this.tagList.indexOf(e)<0&&this.tagList.push(e),this.tagField.reset("")}removeTag(e){this.tagList=this.tagList.filter(t=>t!==e)}submitForm(){this.isSubmitting=!0,this.addTag(),this.articleService.create(b(v({},this.articleForm.value),{tagList:this.tagList})).pipe(h(this.destroyRef)).subscribe({next:e=>this.router.navigate(["/article/",e.slug]),error:e=>{this.errors=e,this.isSubmitting=!1}})}};n.\u0275fac=function(t){return new(t||n)(m(j),m(I),m(R),m(V))},n.\u0275cmp=C({type:n,selectors:[["app-editor-page"]],standalone:!0,features:[D],decls:21,vars:4,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"errors"],[3,"formGroup"],[3,"disabled"],[1,"form-group"],["formControlName","title","type","text","placeholder","Article Title",1,"form-control","form-control-lg"],["formControlName","description","type","text","placeholder","What's this article about?",1,"form-control"],["formControlName","body","rows","8","placeholder","Write your article (in markdown)",1,"form-control"],["type","text","placeholder","Enter tags",1,"form-control",3,"formControl","keyup.enter"],[1,"tag-list"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"],[1,"tag-default","tag-pill"],[1,"ion-close-round",3,"click"],["class","tag-default tag-pill"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u(4,"app-list-errors",4),r(5,"form",5)(6,"fieldset",6)(7,"fieldset",7),u(8,"input",8),o(),r(9,"fieldset",7),u(10,"input",9),o(),r(11,"fieldset",7)(12,"textarea",10),f(13,"              "),o()(),r(14,"fieldset",7)(15,"input",11),d("keyup.enter",function(){return i.addTag()}),o(),r(16,"div",12),k(17,z,3,1,"span",16,N),o()(),r(19,"button",13),d("click",function(){return i.submitForm()}),f(20," Publish Article "),o()()()()()()()),t&2&&(s(4),c("errors",i.errors),s(),c("formGroup",i.articleForm),s(),c("disabled",i.isSubmitting),s(9),c("formControl",i.tagField),s(2),w(i.tagList))},dependencies:[q,P,U,A,G,M,W,$,B],encapsulation:2});let a=n;return a})();export{oe as default};
